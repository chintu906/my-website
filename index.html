<script>

let conversationHistory = [];

function getAIResponse(message) {
  message = message.toLowerCase().trim();

  // Save user message
  conversationHistory.push({ role: "user", text: message });

  // Greeting
  if (message.includes("hello") || message.includes("hi")) {
    return "Hello Dhanush! ğŸ‘‹ Ask me anything!";
  }

  // Remember name
  if (message.includes("my name is")) {
    let name = message.replace("my name is", "").trim();
    conversationHistory.push({ role: "memory", text: name });
    return "Nice to meet you, " + name + " ğŸ˜Š I will remember your name!";
  }

  // If user asks what did I say
  if (message.includes("what did i say")) {
    if (conversationHistory.length > 1) {
      return "Earlier you said: \"" + conversationHistory[conversationHistory.length - 2].text + "\"";
    } else {
      return "This is our first message!";
    }
  }

  // Math explanation
  if (message.includes("math")) {
    return "Math is about numbers and solving problems. You can also type calculations like 5+5.";
  }

  // Calculator
  try {
    if (/^[0-9+\-*/(). ]+$/.test(message)) {
      return "Answer: " + eval(message);
    }
  } catch {
    return "Calculation error.";
  }

  // If user says remember
  if (message.includes("remember")) {
    return "I will try my best to remember our conversation in this session ğŸ˜Š";
  }

  return "Interesting! Tell me more.";
}

function addMessage(text, sender) {
  const chatBox = document.getElementById("chatBox");

  const messageDiv = document.createElement("div");
  messageDiv.className = sender;

  const bubble = document.createElement("div");
  bubble.className = "bubble";
  bubble.textContent = text;

  messageDiv.appendChild(bubble);
  chatBox.appendChild(messageDiv);

  chatBox.scrollTop = chatBox.scrollHeight;
}

function sendMessage() {
  const input = document.getElementById("userInput");
  const message = input.value.trim();
  if (!message) return;

  addMessage(message, "user");
  input.value = "";

  setTimeout(() => {
    const reply = getAIResponse(message);
    addMessage(reply, "ai");
  }, 500);
}

</script>
